function e(e,t,n,l){return new(n||(n=Promise))((function(i,r){function o(e){try{c(l.next(e))}catch(e){r(e)}}function a(e){try{c(l.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((l=l.apply(e,t||[])).next())}))}function t(){const e=document.createElement("div");return e.classList.add("treexplorer-main"),e.role="tree",e.ariaMultiSelectable="false",e.style.setProperty("--indent-2","var(--indent, 1rem)"),e.style.setProperty("--arrow-div-width-2","var(--arrow-div-width, 1.5rem)"),e.style.setProperty("--children-line-width-2","var(--children-line-width, 1px)"),e.style.height="100%",e.style.overflow="auto",e.style.display="grid",e.style.alignContent="start",e}function n(e){const t=document.createElement("div");t.style.userSelect="none";const n=document.createElement("div");n.id=e,n.classList.add("treexplorer-node"),n.style.cursor="pointer",n.style.display="grid",n.style.gridTemplateColumns="var(--arrow-div-width-2) auto",n.style.paddingLeft="calc(var(--left-offset) * var(--indent-2))",n.role="treeitem",n.setAttribute("aria-owns",`children_${e}`);const l=document.createElement("div"),i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center";const r=document.createElement("div");r.style.position="relative",r.style.display="grid",r.style.gridTemplateColumns="1fr";const o=document.createElement("div");o.id=`children_${e}`,o.role="group";const a=document.createElement("div");return a.classList.add("treexplorer-trunk-line"),a.style.backgroundColor="currentColor",a.style.zIndex="1",a.style.position="absolute",a.style.top="0",a.style.left="calc(\n    var(--left-offset)  * var(--indent-2) +\n    var(--arrow-div-width-2) / 2 -\n    var(--children-line-width-2) / 2)",a.style.width="var(--children-line-width-2)",a.style.bottom="0",t.appendChild(n),t.appendChild(r),n.appendChild(i),n.appendChild(l),r.appendChild(a),r.appendChild(o),{container:t,arrow:i,item:n,itemContent:l,children:o}}function l(e){if(e.expanded&&null!=e.family.children&&e.family.children.length>0){l(e.family.children[e.family.children.length-1])}else e.HTML.item.focus()}function i(e){if(e.family.beforeSiblings.length>0){l(e.family.beforeSiblings[e.family.beforeSiblings.length-1])}else null!=e.family.parent&&e.family.parent.HTML.item.focus()}function r(e){return t=>{const n=document.createElement("div");return n.style.whiteSpace="nowrap",n.textContent=e(t),n}}function o(e,t){return n=>{const l=document.createElement("div");l.style.display="flex",l.style.gap="0.5em";const i=document.createElement("img");i.src=t(n);const r=document.createElement("span");return r.style.whiteSpace="nowrap",r.textContent=e(n),l.appendChild(i),l.appendChild(r),l}}function a(l){let o=Object.assign(Object.assign({getChildren:e=>null,getHTML:r((e=>o.getId(e))),getIsInteractive:e=>!0,hideRoots:!1,autoCollapseSiblings:!1},l),{roots:[]}),a=[];const c=new Map;let s=null,d=[],f=0;const u=new Set;function m(...e){e.forEach((e=>u.add(e)))}function p(){const e=[...u.values()];return u.clear(),function(e,t=!0){const n=e.map((e=>L(e,t)));return Promise.all(n)}(e,!1)}function y(e,t){t=void 0===t?!e.selected:t,e.selected!=t&&(s&&(s.selected=!1,m(s),u.add(s)),e.selected=t,m(e)),t&&(s=e,d.forEach((t=>{t(e.object)})))}function h(e,t,n){let l=!e.expanded;if(null!=t&&(l=t),e.expanded=l,m(e),o.autoCollapseSiblings&&e.expanded){const t=[...e.family.afterSiblings,...e.family.beforeSiblings];t.forEach((e=>h(e,!1,!1))),m(...t)}if(null!=t&&t&&null!=n&&n){const t=e.family.parent;null!=t&&h(t,!0,!0)}}function g(e,t){const l=o.getId(e),i=null===t?[]:[...t.path,t.id],r=c.get(l),a=null!=r?r:function(e,t,l,i){return{id:e,path:t,object:l,HTML:n(e),family:{parent:i,children:null,beforeSiblings:[],afterSiblings:[]},expanded:!1,selected:!1}}(l,i,e,t);return c.set(a.id,a),a}function L(t){return e(this,arguments,void 0,(function*(e,t=!0){const n=document.activeElement;e.HTML.item.classList.toggle("non-interactive",!o.getIsInteractive(e.object)),o.getIsInteractive(e.object)?(e.HTML.item.tabIndex=1,e.HTML.item.addEventListener("click",b),e.HTML.item.addEventListener("keydown",v)):(e.HTML.item.tabIndex=-1,e.HTML.item.removeEventListener("click",b),e.HTML.item.removeEventListener("keydown",v));const l=e.path.length-f;e.HTML.container.style.setProperty("--left-offset",""+1*l),e.HTML.item.ariaLevel=`${l}`,e.HTML.item.style.display=l<0?"none":"grid",e.HTML.itemContent.innerHTML="",e.HTML.itemContent.appendChild(o.getHTML(e.object));let i=o.getChildren(e.object);if(i instanceof Promise&&(i=yield i),null==i)e.family.children=null,e.HTML.arrow.innerHTML="",e.HTML.children.style.display="none",e.HTML.children.innerHTML="";else{if(e.family.children=[],e.expanded||t){e.family.children=i.map((t=>g(t,e))),e.HTML.children.innerHTML="";for(const n of e.family.children)yield L(n,t)}if(e.expanded){for(const t of e.family.children)e.HTML.children.appendChild(t.HTML.container);e.HTML.arrow.innerHTML="&#11167;",e.HTML.children.style.display="block"}else e.HTML.arrow.innerHTML="&#11166;",e.HTML.children.style.display="none"}const r=null===e.family.parent?a:e.family.parent.family.children;if(null!=r){const t=r.findIndex((t=>t.id===e.id));e.family.beforeSiblings=r.slice(0,t),e.family.afterSiblings=r.slice(t+1),e.HTML.item.ariaPosInSet=`${t}`}e.HTML.item.classList.toggle("selected",e.selected),null!=n&&n.focus()}))}function b(e){const t=e.target.closest(".treexplorer-node");if(null==t)return;const n=c.get(t.id);null!=n&&(y(n,!0),h(n),p())}function v(e){const t=e.target.closest(".treexplorer-node");if(null==t)return;const n=c.get(t.id);null!=n&&("ArrowUp"===e.key?(e.preventDefault(),i(n)):"ArrowDown"===e.key?(e.preventDefault(),function(e){e.expanded&&null!=e.family.children&&e.family.children.length>0?e.family.children[0].HTML.item.focus():e.family.afterSiblings.length>0?e.family.afterSiblings[0].HTML.item.focus():null!=e.family.parent&&e.family.parent.family.afterSiblings.length>0&&e.family.parent.family.afterSiblings[0].HTML.item.focus()}(n)):"ArrowRight"===e.key?(e.preventDefault(),function(e){if(null!=e.family.children){if(!e.expanded)return e.expanded=!0,!0;e.family.children.length>0&&e.family.children[0].HTML.item.focus()}return!1}(n)&&L(n,!1)):"ArrowLeft"===e.key?(e.preventDefault(),function(e){return null!=e.family.children&&e.expanded?(e.expanded=!1,!0):(null!=e.family.parent&&e.family.parent.HTML.item.focus(),!1)}(n)&&L(n,!1)):"Enter"===e.key&&(y(n,!0),h(n),p()))}function M(){return f=o.hideRoots?1:0,c.forEach((e=>{e.path.length<f&&(e.expanded=!0)})),T}const T={HTML:t(),configure:e=>(o=Object.assign(Object.assign({},o),e),null!=e.roots&&(c.clear(),a=[],T.HTML.innerHTML="",Array.isArray(o.roots)||(o.roots=[o.roots]),o.roots.forEach((e=>{const t=g(e,null);a.push(t),c.set(t.id,t),T.HTML.appendChild(t.HTML.container)})),M()),null!=e.hideRoots&&M(),T),update:()=>(a.forEach((e=>{L(e)})),T),updateNode(e){if(c.has(e)){const t=c.get(e);null!=t&&L(t)}return T},addSelectListener:e=>(d=[...d,e],T),removeSelectListener:e=>(d=d.filter((t=>t!=e)),T),collapseAll:()=>(c.forEach((e=>{e.path.length>=f&&(e.expanded=!1)})),T),expandAll:()=>(c.forEach((e=>{e.expanded=!0})),T),collapseNode(e){if(c.has(e)){const t=c.get(e);null!=t&&h(t,!1,!1)}return T},expandNode(e){if(c.has(e)){const t=c.get(e);null!=t&&h(t,!0,!1)}return T},makeNodeVisible(e){if(c.has(e)){const t=c.get(e);if(null!=t){const e=t.family.parent;null!=e?(h(e,!0,!0),p().then((e=>{t.HTML.item.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}))):t.HTML.item.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}}return T},unselectAll:()=>(s&&(y(s,!1),p()),T),setSelectedNodeItem(e){if(c.has(e)){const t=c.get(e);null!=t&&(y(t,!0),T.makeNodeVisible(t.id))}return T},getRootItems:()=>a.map((e=>e.object)),getNodeItem(e){const t=c.get(e);return null!=t?t.object:null},getSelectedNodeItem:()=>null===s?null:s.object,getNodeItemFamily(e){if(!c.has(e))return null;const t=c.get(e);if(null==t)return null;const n=t.family.parent,l=t.family.beforeSiblings,i=t.family.afterSiblings,r=t.family.children;return{item:t.object,parent:null==n?null:n.object,children:null==r?null:r.map((e=>e.object)),prevSiblings:l.map((e=>e.object)),nextSiblings:i.map((e=>e.object))}}};return T.configure(l),T.update(),T}"function"==typeof SuppressedError&&SuppressedError;export{a as treexplorer,o as treexplorerImageLabelNode,r as treexplorerLabelNode};
