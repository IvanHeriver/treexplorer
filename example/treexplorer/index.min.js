function e(e,t,n,l){return new(n||(n=Promise))((function(i,r){function a(e){try{d(l.next(e))}catch(e){r(e)}}function o(e){try{d(l.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,o)}d((l=l.apply(e,t||[])).next())}))}function t(e,t,n,r,a,o){const d={id:e,path:t,object:n,HTML:l(e),family:{parent:r,children:null,beforeSiblings:[],afterSiblings:[]},expanded:!1,selected:!1};return function(e,t,n){e.HTML.item.addEventListener("pointerup",(()=>{e.expanded=!e.expanded,n(e,!0),t(e)})),e.HTML.item.addEventListener("keydown",(l=>{if("ArrowUp"===l.key)l.preventDefault(),function(e){if(e.family.beforeSiblings.length>0){i(e.family.beforeSiblings[e.family.beforeSiblings.length-1])}else null!=e.family.parent&&e.family.parent.HTML.item.focus()}(e);else if("ArrowDown"===l.key)l.preventDefault(),function(e){if(e.expanded&&null!=e.family.children&&e.family.children.length>0)e.family.children[0].HTML.item.focus();else if(e.family.afterSiblings.length>0){e.family.afterSiblings[0].HTML.item.focus()}else null!=e.family.parent&&e.family.parent.family.afterSiblings.length>0&&e.family.parent.family.afterSiblings[0].HTML.item.focus()}(e);else if("ArrowRight"===l.key){if(l.preventDefault(),null!=e.family.children)if(e.expanded){if(e.family.children.length>0){e.family.children[0].HTML.item.focus()}}else e.expanded=!0,t(e)}else"ArrowLeft"===l.key?(l.preventDefault(),null!=e.family.children&&e.expanded?(e.expanded=!1,t(e)):null!=e.family.parent&&e.family.parent.HTML.item.focus()):"Enter"===l.key&&(e.expanded=!e.expanded,n(e,!0),t(e))}))}(d,a,o),d}function n(){const e=document.createElement("div");return e.classList.add("treexplorer-main"),e.role="tree",e.ariaMultiSelectable="false",e.style.setProperty("--indent-2","var(--indent, 1rem)"),e.style.setProperty("--arrow-div-width-2","var(--arrow-div-width, 1.5rem)"),e.style.setProperty("--children-line-width-2","var(--children-line-width, 1px)"),e.style.height="100%",e.style.overflow="auto",e.style.display="grid",e.style.alignContent="start",e}function l(e){const t=document.createElement("div");t.style.userSelect="none";const n=document.createElement("div");n.classList.add("treexplorer-node"),n.tabIndex=1,n.style.cursor="pointer",n.style.display="grid",n.style.gridTemplateColumns="var(--arrow-div-width-2) auto",n.style.paddingLeft="calc(var(--left-offset) * var(--indent-2))",n.role="treeitem",n.setAttribute("aria-owns",e);const l=document.createElement("div"),i=document.createElement("div");i.style.display="flex",i.style.alignItems="center",i.style.justifyContent="center";const r=document.createElement("div");r.style.position="relative",r.style.display="grid",r.style.gridTemplateColumns="1fr";const a=document.createElement("div");a.id=e,a.role="group";const o=document.createElement("div");return o.classList.add("treexplorer-trunk-line"),o.style.backgroundColor="currentColor",o.style.zIndex="1",o.style.position="absolute",o.style.top="0",o.style.left="calc(\n    var(--left-offset)  * var(--indent-2) +\n    var(--arrow-div-width-2) / 2 -\n    var(--children-line-width-2) / 2)",o.style.width="var(--children-line-width-2)",o.style.bottom="0",t.appendChild(n),t.appendChild(r),n.appendChild(i),n.appendChild(l),r.appendChild(o),r.appendChild(a),{container:t,arrow:i,item:n,itemContent:l,children:a}}function i(e){if(e.expanded&&null!=e.family.children&&e.family.children.length>0){i(e.family.children[e.family.children.length-1])}else e.HTML.item.focus()}function r(l){const i=Object.assign({},l),r=[],a=new Map;let o=null,d=[];function s(e,t){t=void 0===t?!e.selected:t,e.selected!=t&&(o&&(o.selected=!1,u(o)),e.selected=t,u(e)),t&&(o=e,d.forEach((t=>{t(e.object)})))}function c(e,t,n){let l=!e.expanded;if(null!=t&&(l=t),e.expanded=l,null!=t&&t&&null!=n&&n){const t=e.family.parent;if(null!=t)return c(t,!0,!0)}return e}function f(e,n){const l=i.getId(e),r=null===n?[]:[...n.path,n.id],o=a.get(l),d=null!=o?o:t(l,r,e,n,u,s);return a.set(d.id,d),d}function u(t){return e(this,void 0,void 0,(function*(){const e=document.activeElement,n=t.path.length;t.HTML.container.style.setProperty("--left-offset",""+1*n),t.HTML.item.ariaLevel=`${n}`,t.HTML.itemContent.innerHTML="",t.HTML.itemContent.appendChild(i.getHTML(t.object));let l=i.getChildren(t.object);if(l instanceof Promise&&(l=yield l),null==l)t.family.children=null,t.HTML.arrow.innerHTML="",t.HTML.children.style.display="none";else{t.family.children=[],t.family.children=l.map((e=>f(e,t))),t.HTML.children.innerHTML="";for(const e of t.family.children)t.HTML.children.appendChild(e.HTML.container),yield u(e);t.expanded?(t.HTML.arrow.innerHTML="&#11167;",t.HTML.children.style.display="block"):(t.HTML.arrow.innerHTML="&#11166;",t.HTML.children.style.display="none")}const a=null===t.family.parent?r:t.family.parent.family.children;if(null!=a){const e=a.findIndex((e=>e.id===t.id));t.family.beforeSiblings=a.slice(0,e),t.family.afterSiblings=a.slice(e+1),t.HTML.item.ariaPosInSet=`${e}`}t.HTML.item.classList.toggle("selected",t.selected),null!=e&&e.focus()}))}const p={HTML:n(),setRoots:e=>(i.roots=e,r.length=0,p.HTML.innerHTML="",i.roots.forEach((e=>{const t=f(e,null);r.push(t),p.HTML.appendChild(t.HTML.container)})),p),setGetId:e=>(i.getId=e,p),setGetHTML:e=>(i.getHTML=e,p),setGetChildren:e=>(i.getChildren=e,p),update:()=>(r.forEach((e=>{u(e)})),p),updateNode(e){if(a.has(e)){const t=a.get(e);null!=t&&u(t)}return p},addSelectListener:e=>(d=[...d,e],p),removeSelectListener:e=>(d=d.filter((t=>t!=e)),p),collapseAll:()=>(a.forEach((e=>{e.expanded=!1})),p),expandAll:()=>(a.forEach((e=>{e.expanded=!0})),p),expandNode(e){if(a.has(e)){const t=a.get(e);null!=t&&c(t,!0,!1)}return p},makeNodeVisible(e){if(a.has(e)){const t=a.get(e);if(null!=t){u(c(t,!0,!0)).then((e=>{t.HTML.container.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})}))}}return p},unselectAll:()=>(o&&s(o,!1),p),setSelectedNodeItem(e){if(a.has(e)){const t=a.get(e);null!=t&&(s(t,!0),p.makeNodeVisible(t.id))}return p},getNodeItem(e){const t=a.get(e);return null!=t?t.object:null},getSelectedNodeItem:()=>null===o?null:o.object,getNodeItemFamily(e){if(!a.has(e))return null;const t=a.get(e);if(null==t)return null;const n=t.family.parent,l=t.family.beforeSiblings,i=t.family.afterSiblings,r=t.family.children;return{item:t.object,parent:null==n?null:n.object,children:null==r?null:r.map((e=>e.object)),prevSiblings:l.map((e=>e.object)),nextSiblings:i.map((e=>e.object))}}};return p.setGetId(i.getId),p.setGetChildren(i.getChildren),p.setGetHTML(i.getHTML),p.setRoots(i.roots),p.update(),p}function a(e){return t=>{const n=document.createElement("div");return n.style.whiteSpace="nowrap",n.textContent=e(t),n}}function o(e,t){return n=>{const l=document.createElement("div");l.style.display="flex",l.style.gap="0.5em";const i=document.createElement("img");i.src=t(n);const r=document.createElement("span");return r.style.whiteSpace="nowrap",r.textContent=e(n),l.appendChild(i),l.appendChild(r),l}}"function"==typeof SuppressedError&&SuppressedError;export{r as treexplorer,o as treexplorerImageLabelNode,a as treexplorerLabelNode};
